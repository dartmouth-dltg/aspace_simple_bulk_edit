<% dates.each_with_index do |date, date_idx| %>
  <div 
    class="aspace-simple-bulk-edit-summary-extent extent-type-<%= date['date_type'] %>"
    data-date-index="<%=date_idx%>"
    data-index="<%= index %>"
    data-ao-ref="<%= ao_ref %>"
    data-ao-id="<%= ao_id %>"
  >
    <button class="btn btn-default remove-date" data-date-index="<%=date_idx%>"><%= I18n.t("aspace_simple_bulk_edit.summary.remove_date") %></button>
    <div class="form-group aspace-simple-bulk-edit-date-label">
      <label for="aspace_simple_bulk_edit_date_label_select_<%= index %>" class="sr-only">Date Label</label>
      <%= select_tag "aspace_simple_bulk_edit_date_label_select_#{index}", options_for_select(date_labels, date['label']), :required => true, "data-ao-date-label" => ao_id, :class => "form-control"  %>
    </div>
    <div class="form-group aspace-simple-bulk-edit-date-type">
      <label for="aspace_simple_bulk_edit_date_type_select_<%= index %>" class="sr-only">Date Type</label>
      <%= select_tag "aspace_simple_bulk_edit_date_type_select_#{index}", options_for_select(date_types, date['date_type']), :required => true, "data-ao-date-type" => ao_id, :class => "form-control"  %>
    </div>

    <div class="aspace-simple-bulk-edit-date-expression">
      <div class="form-group">
        <label for="ao_expression_date_<%= ao_ref %>"><%= I18n.t("aspace_simple_bulk_edit.summary.date_expression") %></label>
        <textarea rows="2" id="ao_expression_date_<%= ao_ref %>" type="text" name="ao_expression_date_<%= ao_ref %>" class="form-control" data-ao-date-exp="<%= ao_id %>" data-date="<%= Date.today %>" data-autoclose="true" data-force-parse="false"><%= date['expression'].nil? ? '' : date['expression'] %></textarea>
      </div>
    </div>

    <div class="aspace-simple-bulk-edit-date-begin">
      <div class="form-group date">
        <label for="ao_begin_date_<%= ao_ref %>"><%= I18n.t("aspace_simple_bulk_edit.summary.date_begin") %></label>
        <input id="ao_begin_date_<%= ao_ref %>" type="text" value="<%= date['begin'] rescue '' %>" name="ao_begin_date_<%= ao_ref %>" class="date-field form-control" data-ao-date-begin="<%= ao_id %>"  data-format="yyyy-mm-dd" data-date="<%= Date.today %>" data-autoclose="true" data-force-parse="false" data-label="<%= I18n.t("aspace_simple_bulk_edit.summary.date_begin") %>" />
      </div>
    </div>

    <div class="aspace-simple-bulk-edit-date-end">
      <div class="form-group date">
        <label for="ao_end_date_<%= ao_ref %>"><%= I18n.t("aspace_simple_bulk_edit.summary.date_end") %></label>
        <input id="ao_end_date_<%= ao_ref %>" type="text" value="<%= date['end'] rescue '' %>" name="ao_end_date_<%= ao_ref %>" class="date-field form-control" data-ao-date-end="<%= ao_id %>" data-format="yyyy-mm-dd" data-date="<%= Date.today %>" data-autoclose="true" data-force-parse="false"data-label="<%= I18n.t("aspace_simple_bulk_edit.summary.date_end") %>" />
      </div>
    </div>
    <input type="hidden" data-ao-date-certainty="<% ao_id %>" id="ao_date_certainty<%= ao_ref %>_<% date_idx %>"value="<% date['certainty'].nil? ? '' : date['certainty'] %>" />
    <input type="hidden" data-ao-date-era="<% ao_id %>" id="ao_date_era_<%= ao_ref %>_<% date_idx %>" value="<% date['era'].nil? ? '' : date['era'] %>" />
    <input type="hidden" data-ao-date-calendar="<% ao_id %>" id="ao_date_calendar_<%= ao_ref %>_<% date_idx %>" value="<% date['calendar'].nil? ? '' : date['calendar'] %>" />
  </div>
<% end %>
<div id="simple-bulk-edit-dates-template">
  <div 
    class="aspace-simple-bulk-edit-summary-date date-type-new">
    <button class="btn btn-default remove-date" data-date-index="${dateIndex}"><%= I18n.t("aspace_simple_bulk_edit.summary.remove_date") %></button>
    <div class="form-group aspace-simple-bulk-edit-date-type">
      <label for="aspace_simple_bulk_edit_date_type_select_<%= index %>_${dateIndex}" class="sr-only">Date Type</label>
      <%= select_tag "aspace_simple_bulk_edit_date_type_select_#{index}_${dateIndex}", options_for_select(date_types, "none"), :required => true, "data-ao-date-type" => ao_id, :class => "form-control"  %>
    </div>

    <div class="aspace-simple-bulk-edit-date-expression">
      <div class="form-group">
        <label for="ao_expression_date_<%= ao_ref %>_${dateIndex}"><%= I18n.t("aspace_simple_bulk_edit.summary.date_expression") %></label>
        <textarea rows="2" id="ao_expression_date_<%= ao_ref %>_${dateIndex}" type="text" name="ao_expression_date_<%= ao_ref %>_${dateIndex}" class="form-control" data-ao-date-exp="<%= ao_id %>" data-date="<%= Date.today %>" data-autoclose="true" data-force-parse="false"></textarea>
      </div>
    </div>

    <div class="aspace-simple-bulk-edit-date-begin">
      <div class="form-group date">
        <label for="ao_begin_date_<%= ao_ref %>_${dateIndex}"><%= I18n.t("aspace_simple_bulk_edit.summary.date_begin") %></label>
        <input id="ao_begin_date_<%= ao_ref %>_${dateIndex}" type="text" value="" name="ao_begin_date_<%= ao_ref %>_${dateIndex}" class="date-field form-control" data-ao-date-begin="<%= ao_id %>"  data-format="yyyy-mm-dd" data-date="<%= Date.today %>" data-autoclose="true" data-force-parse="false" data-label="<%= I18n.t("aspace_simple_bulk_edit.summary.date_begin") %>" />
      </div>
    </div>

    <div class="aspace-simple-bulk-edit-date-end">
      <div class="form-group date">
        <label for="ao_end_date_<%= ao_ref %>_${dateIndex}"><%= I18n.t("aspace_simple_bulk_edit.summary.date_end") %></label>
        <input id="ao_end_date_<%= ao_ref %>_${dateIndex}" type="text" value="" name="ao_end_date_<%= ao_ref %>_${dateIndex}" class="date-field form-control" data-ao-date-end="<%= ao_id %>" data-format="yyyy-mm-dd" data-date="<%= Date.today %>" data-autoclose="true" data-force-parse="false"data-label="<%= I18n.t("aspace_simple_bulk_edit.summary.date_end") %>" />
      </div>
    </div>
    <input type="hidden" data-ao-date-certainty="<% ao_id %>" id="ao_date_certainty<%= ao_ref %>_${dateIndex}" value="" />
    <input type="hidden" data-ao-date-era="<% ao_id %>" id="ao_date_era_<%= ao_ref %>_${dateIndex}" value="" />
    <input type="hidden" data-ao-date-calendar="<% ao_id %>" id="ao_date_calendar_<%= ao_ref %>_${dateIndex}" value="" />
  </div>
</div>